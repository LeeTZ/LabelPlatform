<html>
<head>
	<title>Dressing Room</title>

	<link rel="stylesheet" type="text/css" href="css/semantic.min.css">
    <script src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/semantic.min.js"></script>

    <style>
        .container{
            padding: 2em 0em 2em;
        }
        .num{
            padding-left: 20px;
            margin-top: 10px;
        }

    </style>
</head>
<body>
<div class="container">
<div class="ui two column divided grid">
    <div class="three wide column">

        <div class="ui segment" style="margin-left: 20px;">
            <div class="ui header">
            Personal Information
            </div>
            <a class="ui pink ribbon label" >User</a>

            <p style="margin-top: 20px;"><img class="ui avatar image" src="/images/steve.jpg"><span id="userName">Xu Wang</span></p>
            <a class="ui teal ribbon label">Label Count</a>
            <p class="num"  id="labelCount">100</p>
            <a class="ui red ribbon label">Check Count</a>
            <p class="num" id="checkCount">100</p>
            <a class="ui green ribbon label">Upload Count</a>
            <p class="num" id="uploadCount">0</p>
        </div>
        <div class="ui  divider">

        </div>
        <div class="ui segment" style="margin-left: 20px;">
            <div class="ui header">
                statistics
            </div>
            <a class="ui pink ribbon label">Total Pictures</a>
            <p class="num" id="totalImageCount">0</p>
            <a class="ui blue ribbon label">Labeled</a>
            <p class="num" id="totalLabelCount">0</p>
            <a class="ui green ribbon label">Checked</a>
            <p class="num" id="totalCheckCount">0</p>
            <a class="ui teal ribbon label">Undone</a>
            <p class="num" id="totalUndoneCount">0</p>
            <a class="ui red ribbon label">By Machine</a>
            <p class="num" id="totalMachineCount">0</p>

        </div>
    </div>

    <div class="thirteen wide column" style="padding-right: 40px;">
        <div class="ui header">
            Filter
        </div>
        <p>Select the items to check images.</p>
        <div class="ui form" style="padding-bottom: 40px;">
            <div class="grouped inline fields" id="checkBox">
                <div class="field">
                    <div class="ui radio checkbox">
                        <input type="radio" name="fruit" checked="checked" selectValue="-1">
                        <label>All Image</label>
                    </div>
                </div>
                <div class="field">
                    <div class="ui radio checkbox">
                        <input type="radio" name="fruit" selectValue="2">
                        <label>Labeled Image</label>
                    </div>
                </div>

                <div class="field">
                    <div class="ui radio checkbox">
                        <input type="radio" name="fruit" selectValue="4">
                        <label>Checked</label>
                    </div>
                </div>
                <div class="field">
                    <div class="ui radio checkbox">
                        <input type="radio" name="fruit" selectValue="0">
                        <label>Undone</label>
                    </div>

                </div>
                <div class="field">
                    <div class="ui radio checkbox" selectValue="0">
                        <input type="radio" name="fruit">
                        <label>ByMachine</label>
                    </div>

                </div>
            </div>
        </div>
        <div class="grid">
            <div class="ui five column grid" id="ImageList">

            </div>

        </div>

    </div>
</div>
</div>
<script>
    var userId = "547e7f3048a8688c1f403ea6";
    var labelCount;
    var checkCount;
    var uploadCount;
    var totalPics;
    var labeledPics;
    var checkedPics;
    var undonePics;
    var byMachinePics;
    var filterType = -1;/**-1, allImage, 0, LabeledImage 1, SublabeledImage, 2, Checked, 3 Undone, 4, ByMachine.*/
    var totalRequestNum;
    var nextRequestNum = 0;
    var eachCount = 20;
    (function getUserInfo()
    {
        $.ajax({
            type:'POST',
            url:'/calculate/user',
            data:{'userId':userId},
            success:function(result){
                console.log(result);
                if(result.status == 1){
                    var userInfo = result.msg;
                    $('#userName').text(userInfo.userName);
                    $('#labelCount').text(userInfo.labelPointCount);
                    $('#checkCount').text(userInfo.validateCount);
                    $('#uploadCount').text(userInfo.createImageCount);

                }


            },
            dataType:'json'
        });

    })();
    (function getStatistics(){
        $.ajax({
           type:'POST',
            url:'/calculate/totalImage',
            success:function(result){
                console.log(result);
                if(result.status == 1){
                    var ImageInfo = result.msg;
                    $('#totalImageCount').text(ImageInfo.totalCount);
                    $('#totalLabelCount').text(ImageInfo.labelCount);
                    $('#totalCheckCount').text(ImageInfo.checkCount);
                    $('#totalUndoneCount').text(ImageInfo.undoneCount);
                    $('#totalMachineCount').text(ImageInfo.machineCount);

                }


            },
            dataType:'json'
        });

    })();
    function generateOneImage(url)
    {

        var item = $("<div class=\"column\"><div class=\"ui segment\"><img src=\"\" class=\"ui fluid image\"></div> </div>");
        item.find('img').attr('src', url);
        return item;
    }
    function getImage()
    {
        $.ajax({
           type:'POST',
           url:'/filter',
           data:{'type':filterType, 'num':eachCount, 'skipNum':nextRequestNum},
           success:function(result){
               console.log(result);

                if(result.status == 1)
                {
                    var imageList = $('#ImageList');
                    nextRequestNum = nextRequestNum + imageList.length;
                    for(var item in result.msg){
                        var imageUrl = result.msg[item].picUrl_l;
                        var item = generateOneImage(imageUrl);
                        imageList.append(item);
                    }



                }


            },
            dataType:'json'
        });
    }
    getImage();
    $('.ui.checkbox').checkbox();
    $(document).scroll(function(){
       if($(document).scrollTop() >= $(document).height() - $(window).height())
       {
            getImage();
       }

    });
    $("#checkBox").click(function(){
        var selectValue = parseInt($('input:checked').attr('selectValue'));
        nextRequestNum = 0;
        filterType=selectValue;
        console.log(selectValue);
        $('#ImageList').empty();
        getImage();
    });




</script>

</body>
</html>
